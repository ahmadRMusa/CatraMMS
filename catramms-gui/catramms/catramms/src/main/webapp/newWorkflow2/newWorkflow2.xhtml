<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:media="http://xmlns.jcp.org/jsf/composite/media">

<f:metadata>
    <!--
    <f:viewParam name="predefined" value="#{newWorkflow.predefined}" />
    <f:viewParam name="data" value="#{newWorkflow.data}" />
    <f:viewAction action="#{newWorkflow.init}" />
    -->
</f:metadata>

<h:head>

    <h:outputStylesheet library="css" name="catramms.css"  />

</h:head>

<h:body>

    <ui:include src="/common/loadingDialog.xhtml"/>
    <ui:include src="/common/globalConfirm.xhtml"/>
    <!-- <ui:include src="newWorkflowDialogs.xhtml"/> -->

    <h:form id="viewForm" enctype="multipart/form-data">

        <p:growl id="growl" showDetail="true" sticky="false" escape="false" life="2000">
            <p:autoUpdate />
        </p:growl>

        <p:toolbar>
            <p:toolbarGroup align="left">
                <p:outputLabel styleClass="appTitle" value="Media Management System" />
            </p:toolbarGroup>

            <p:toolbarGroup align="right">

                <p:outputLabel value="Welcome #{sessionScope.userProfile.name}" />

                <span class="ui-separator">
                    <span class="ui-icon ui-icon-grip-dotted-vertical" />
                </span>

                <p:outputLabel value="Workspace:" />
                <p:selectOneMenu id="workspaceName" value="#{newWorkflow2.workspaceName}"
                                 autoWidth="false">
                    <f:selectItems value="#{newWorkflow2.workspaceNames}" />
                    <p:ajax
                            global="true"
                            event="change"
                            listener="#{newWorkflow2.init}"
                             />
                </p:selectOneMenu>

                <span class="ui-separator">
                    <span class="ui-icon ui-icon-grip-dotted-vertical" />
                </span>

                <p:commandLink value="Logout" action="#{login.logout}" />

                <span class="ui-separator">
                    <span class="ui-icon ui-icon-grip-dotted-vertical" />
                </span>

                <ui:include src="/common/mainMenu.xhtml"/>

            </p:toolbarGroup>
        </p:toolbar>

        <p:toolbar>
            <p:toolbarGroup align="left">

                <span class="ui-separator">
                    <span class="ui-icon ui-icon-grip-dotted-vertical" />
                </span>

                <p:outputLabel styleClass="viewTitle" value="New Workflow" />

            </p:toolbarGroup>

            <p:toolbarGroup align="right">

                <!--
                <p:commandButton id="ingestWorkflowButton" global="true" value="Ingest Workflow"
                                 actionListener="#{newWorkflow.ingestWorkflow}"
                                 disabled="#{newWorkflow.workflowIssueList.size() > 0 || !sessionScope.currentWorkspaceDetails.ingestWorkflow}"
                                 update="ingestionWorkflowResultsForm"
                                 oncomplete="PF('ingestionWorkflowResults').show()">
                    <p:confirm header="Confirmation" message="Are you sure?" icon="ui-icon-alert" />
                </p:commandButton>

                <span class="ui-separator">
                    <span class="ui-icon ui-icon-grip-dotted-vertical" />
                </span>

                <p:commandButton id="jsonWorkflowButton" global="true"
                                 disabled="#{!sessionScope.currentWorkspaceDetails.admin}"
                                 icon="fa fa-file-code-o"
                                 oncomplete="PF('jsonWorkflowWidget').show()"
                        />

                <span class="ui-separator">
                    <span class="ui-icon ui-icon-grip-dotted-vertical" />
                </span>

                <p:commandButton id="workflowIssuesWarning" global="true"
                                 styleClass="#{(newWorkflow.workflowIssueList.size() > 0) ? 'blink' : ''}" icon="fa fa-warning"
                                 disabled="#{newWorkflow.workflowIssueList.size() == 0}"
                                 update="workflowIssuesForm"
                                 oncomplete="PF('workflowIssues').show()"
                        />
-->
            </p:toolbarGroup>
        </p:toolbar>

        <style type="text/css">
            .ui-diagram-element {
                border:0.1em dotted #E5E4E2;
                background-color: #EFEEEC;
                width:10em;
                height:8em;
                text-align: center;
                box-shadow: 0 5px 10px rgba(0, 0, 0, 0.8);
            }

            .ui-diagram-element:hover {
                background-color: #C7C6C4;
            }
        </style>

        <ui:include src="/newWorkflow2/libraryMenu.xhtml"/>

        <p:diagram id="workspaceDiagram" value="#{newWorkflow2.model}" style="height:600px" styleClass="ui-widget-content" var="el">
            <f:facet name="element">
                <h:outputText value="#{el.name}" style="display:block;margin-top:1em;"/>
                <!-- <p:graphicImage name="demo/images/#{el.image}" /> -->
            </f:facet>
            <p:ajax event="connect" listener="#{newWorkflow2.onConnect}" />
            <p:ajax event="disconnect" listener="#{newWorkflow2.onDisconnect}" />
            <p:ajax event="connectionChange" listener="#{newWorkflow2.onConnectionChange}" />
        </p:diagram>

        <p:dock position="bottom">
            <p:menuitem value="Home" icon="#{newWorkflow2.addContentIcon}" url="#"/>
            <p:menuitem value="Music" icon="#{newWorkflow2.addContentIcon}" url="#"/>
            <p:menuitem value="Video" icon="#{newWorkflow2.addContentIcon}" url="#"/>
            <p:menuitem value="Email" icon="#{newWorkflow2.addContentIcon}" url="#"/>
            <p:menuitem value="Portfolio" icon="#{newWorkflow2.addContentIcon}" url="#"/>
            <p:menuitem value="Link" icon="#{newWorkflow2.addContentIcon}" url="#"/>
            <p:menuitem value="RSS" icon="#{newWorkflow2.addContentIcon}" url="#"/>
            <p:menuitem value="History" icon="#{newWorkflow2.addContentIcon}" url="#"/>
        </p:dock>

    </h:form>

</h:body>
</html>